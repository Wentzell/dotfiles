#################### TMUX CONF #################### 

unbind-key C-b #no more C^b
unbind-key [

set -g base-index 1
setw -g pane-base-index 1

# Terminal settings
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Mouse support
set -g mouse on

# Vi mode
setw -g mode-keys vi
set -g status-keys vi
set -g repeat-time 1000
set -sg escape-time 0

set -g default-shell /mnt/sw/nix/state/profiles/x86_64/rocky8/shell/bin/zsh
set -g default-command /mnt/sw/nix/state/profiles/x86_64/rocky8/shell/bin/zsh # Avoid login-shells

set-option -g history-limit 50000

# Semicolon is the only key that isn't bound by readline
# this creates a problem inside of ttys...
set-option -g prefix C-f
bind-key f send-prefix

# All sorts of Vi-type bindings
# https://github.com/justone/dotfiles/blob/personal/.tmux.shared#L3
# VI for switching between
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R
bind-key s splitw -v
bind-key v splitw -h
bind-key S choose-session  
bind-key e last-window

# keybindings to make resizing easier
bind-key -r C-h resize-pane -L
bind-key -r C-j resize-pane -D
bind-key -r C-k resize-pane -U
bind-key -r C-l resize-pane -R
bind-key | resize-pane -Z \; display-message "Zoom zoom zoom"

# Vi copy and paste in tmux
# http://joncairns.com/2013/06/copying-between-tmux-buffers-and-the-system-clipboard/
# http://www.rushiagr.com/blog/2016/06/16/everything-you-need-to-know-about-tmux-copy-pasting-ubuntu/
bind-key [ copy-mode

bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'xclip -in'
bind-key -T copy-mode-vi 'r' send -X rectangle-toggle
bind-key 'P' paste-buffer

# only if this is the first level of inception do that fancy status bar
if-shell 'test "$(uname -s)" = "Darwin"' 'bind-key y run-shell "tmux show-buffer | pbcopy" \; display-message "Copied tmux buffer to system clipboard"'
if-shell 'test "$(uname -s)" = "Linux"' 'bind-key y run-shell "tmux show-buffer | xsel -pi" \; display-message "Copied tmux buffer to system clipboard"'

# Window style
set -g window-style "fg=default,bg=default"
set -g window-active-style "fg=default,bg=default"

# Kanagawa Color Scheme
# Based on https://github.com/rebelot/kanagawa.nvim
# Color definitions
kanagawa_dark_gray="#16161D"
kanagawa_gray="#2A2A37"
kanagawa_light_gray="#727169"
kanagawa_light_blue="#7fb4ca"
kanagawa_yellow="#e6c384"
kanagawa_white="#dcd7ba"
kanagawa_pink="#D27E99"
kanagawa_green="#98bb6c"
kanagawa_red="#C34043"

# Pane borders
set -g pane-border-style "fg=$kanagawa_gray"
set -g pane-active-border-style "fg=$kanagawa_light_blue"
set -g pane-border-lines "single"

# Pane indicators
set -g display-panes-colour "$kanagawa_light_blue"
set -g display-panes-active-colour "$kanagawa_light_blue"

# Status line style (overridden to transparent at end of file)
set -g status-style "fg=$kanagawa_light_gray,bg=$kanagawa_dark_gray"

# Message style
set -g message-style "fg=$kanagawa_dark_gray,bg=$kanagawa_yellow,bold"
set -g message-command-style "fg=$kanagawa_yellow,bg=$kanagawa_dark_gray,bold"

# Mode style (copy mode)
set -g mode-style "fg=$kanagawa_dark_gray,bg=$kanagawa_yellow,bold"

# Window status
setw -g window-status-style "fg=$kanagawa_light_gray,bg=$kanagawa_dark_gray"
setw -g window-status-format " #I #W#{?#{||:#{window_bell_flag},#{window_zoomed_flag}}, ,}#{?window_bell_flag,!,}#{?window_zoomed_flag,Z,} "

setw -g window-status-current-style "fg=$kanagawa_dark_gray,bg=$kanagawa_light_blue,bold"
setw -g window-status-current-format " #I #W#{?#{||:#{window_bell_flag},#{window_zoomed_flag}}, ,}#{?window_bell_flag,!,}#{?window_zoomed_flag,Z,} "

# Window activity and bell styles
setw -g window-status-activity-style "fg=default,bg=default,underscore"
setw -g window-status-bell-style "fg=$kanagawa_yellow,bg=default,blink,bold"

# Status bar content
set -g status-left " ❐ #S "
set -g status-right " #{?client_prefix,⌨ ,}#{?mouse,↗ ,}#{?synchronize-panes,⚏ ,}| #h "

# Status bar colors
set -g status-left-style "fg=$kanagawa_dark_gray,bg=$kanagawa_yellow,bold"
set -g status-right-style "fg=$kanagawa_light_gray,bg=$kanagawa_dark_gray"

# Clock (when you hit prefix + t)
set -g clock-mode-colour "$kanagawa_light_blue"
set -g clock-mode-style 24

# Terminal title
set -g set-titles on
set -g set-titles-string "#h ❐ #S ● #I #W"
